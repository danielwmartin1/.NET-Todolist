@model List<TodoListApp.Models.TodoItem>

<!DOCTYPE html>
<html>
<head>
  <title>.NET Todo List</title>
  <link rel="stylesheet" href="~/css/styles.css" />
  <script src="~/js/main.js" type="module" defer></script>
</head>
  <body class="mt4 pt4">
    <nav class="navbar full-width center-content center-text">
        <h1 class="navbar-title">.NET Todo List</h1>
    </nav>
    <form asp-action="Add" method="post" class="form-inline">
      <input type="text" name="Title" class="form-control" placeholder="Add new item" required autofocus />
      <button type="submit" class="btn btn-primary">Add</button>
    </form>
    
    <div class="flex-container">
      <div class="container mt-4 full-width flex-item">
        <ul class="list-group mt-4">
          @if (Model != null)
          {
              foreach (var item in Model)
              {
                  <li class="list-group-item">
                      <div>
                          <form asp-action="Toggle" method="post" class="d-inline">
                              <input type="hidden" name="id" value="@item.Id" />
                              <input type="checkbox" name="IsCompleted" value="true" @(item.IsCompleted ? "checked" : "") onchange="this.form.submit()" />
                              <span class="@(item.IsCompleted ? "completed-title" : "")">@item.Title</span>
                          </form>
                      </div>
                      <div>
                          <form asp-action="Delete" method="post" class="d-inline">
                              <input type="hidden" name="id" value="@item.Id" />
                              <button type="submit" class="btn btn-danger">Delete</button>
                          </form>
                          <button class="btn btn-secondary" onclick="toggleEditForm(@item.Id)">Edit</button>
                      </div>
                      <div id="edit-form-@item.Id" style="display:none;">
                          <form asp-action="Update" method="post" class="form-inline">
                              <input type="hidden" name="id" value="@item.Id" />
                              <input type="text" name="Title" class="form-control" value="@item.Title" required />
                              <button type="submit" class="btn btn-primary">Update</button>
                              <button type="button" class="btn btn-secondary" onclick="toggleEditForm(@item.Id)">Cancel</button>
                          </form>
                      </div>
                  </li>
              }
          }
        </ul>
      </div>
    </div>

  </body>
      <footer class="footer full-width center-content center-text">
      <div class="container">
        <span class="footer">Daniel Martin Â© @DateTime.Now.Year</span>
      </div>
    </footer>
    <script>
        function toggleEditForm(id) {
            console.log(`Toggling edit form for TodoItem with Id=${id}`);
            const form = document.getElementById(`edit-form-${id}`);
            if (!form) {
                console.error(`Edit form not found for Id=${id}`);
                return;
            }
            form.style.display = form.style.display === 'none' ? 'block' : 'none';
        }
    </script>
</html>